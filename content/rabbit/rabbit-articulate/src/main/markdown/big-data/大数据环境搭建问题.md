# 大数据环境搭建问题

## 1. 前言

在集群搭建中所需要拟解决关键问题，具体给出如下四点：

    1.集群节点数及节点性能的设计，zookeeper集群的节点分配；

    2.Namenode和resourcemanager的单节点故障问题；

    3.redis的数据恢复设计；

    4.节点挂掉之后的数据恢复

### 1.1. 配置需求
---
- [ ] 日信息存储量，每日增加的信息存储量，每周的存储数据量。
- [ ] 日消息通信量，每分通信量，每秒通信量。
---
例如：每周增加10GB，三个HDFS腹部，那么每周额外30GB作为原始的数据存储工具。需要中间文件和日志空间33%容量，即9.9G。合算一周40GB左右，如果会进行定期增加新机器。

方案一，T，预期存储数据时间（天数）；预期每周新机器容量C；预期机器台数N;预期初始投入机器配置容量P。

$$
N=\frac{40(\frac{T}{7}*40-C)}{P}
$$

方案二，无追加新机器投入。

$$
N=\frac{40T}{7P}
$$
## 1.2. 设计问题与故障问题

集群主要由13台机器构成，基础方案主要考虑集群稳定性等因素做出的一种资源分配方案。11台机器主要由3台机器组成Web服务器与Redis服务器集群，主要考虑Redis作为缓存服务的支持，和Web服务器部署在一块有利于提供本地化的服务，进而快速传输，但增加了服务器压力。对于额外的两台会部署Zookeeper用于Kafka与Hbase集群的容灾。

![image](D:\Downloads\Image\大数据平台部署设计\1.png)

另外由三台组成Kafka集群，提供消息队列服务，而其中集群两台涵盖连接HDFS业务的消费者服务部署。

![image](D:\Downloads\Image\大数据平台部署设计\2.png)

最后由五台机器构成备份为3的HDFS集群与Hbase集群。集群Namenode节点两个，SecondNamenode独立一台机器遇Jobtracker节点合并在一起。

![image](D:\Downloads\Image\大数据平台部署设计\3.png)

对于Namenode，启用多节点；其次SecondNamenode对立使用和Namenode等配置的节点。


关于网络交换机，路由器。在集群内部使用千兆级别的虚拟网卡。虽然是虚拟机搭建的集群，对于出口应该使用配置高的交换机。